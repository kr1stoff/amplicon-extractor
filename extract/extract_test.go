package extract

import (
	"fmt"
	"os"
	"testing"

	"github.com/agnivade/levenshtein"
)

func TestCalcHammingDistance(t *testing.T) {
	fmt.Fprintln(os.Stdout, levenshtein.ComputeDistance("AGCT", "AGTC"))
}

func TestGetPrimerPositionOnGenome(t *testing.T) {
	genomeSequence := `
	GTGAATGAAGATGGCGTCTAACGACGCTTCCGCTGCCGTTGCTGGCAAAAACAACAACAACGACAAGGAAAAATCTTCAA
	GTGACAGCTTGTTTGCTAACATGTCTGTCACTTTTAAGAAAGCCCTCGGGGCGCGGTCTAAACAACCGCCCCCGGGAGAA
	ACAAAACAAATACAAAAACCACCAAGGCCACCGACACCGGAATTGGTGAAGAGAATACCTCCACCCCCACCCAATGGCGA
	GGATGAACCAGGGATAGTGTACAAGGTGGGAGAGGGTGTGTCTGGGCTGCCCGACCTAACAACTGTGGTACAACCTGACG
	CACAAAACACAGCTTATAGTGTTCCCCCACTTAGCCAGAGAGAAGTCGGCGAAGCTAAAGAACCGCTGCCTGGCTCCATT
	CTGGAAATGTGGGATGGTGAGATCTACCACTATGGGCTGTATGTTGAGCGGGGGCATGTGCTCGGAGTACACAAACCACC
	TGCTGCAATAAGCCTTGCCAAAATTGAAATAACACCGCTGTCTCTCTACTGGAGAGTGGTCTACACTCCCCAGTATTTGA
	TAGATCCAGGAACTCTTAAGAACTTGAGTGGAGAGACTTTCCCATACACGGCCTTTGACAACAACTGTTATGCCTTCTGT
	TGTTGGGTCCTAGACCTCAACGACTCCTGGCTTAGCAGGAGAATGATCCAAAGAACAACTGGATTCTTCAAACCTTATCA
	GGATTGGAACAGAAAACCCTTACCAACCATGGATGAACCGAAAATCAAGAAGGCCGCGAATGCTGTCCTATGCGCTCTCT
	CCTCACTCTTCACTAGACCCATTAAGGACATCATTGGAAAGCTTAGACCACTGAACATTCTTAATATACTGGCAACCTGC
	GATTGGACTTTTGCAGGCATAGTGGAATCCTTGATCCTTCTTGCTGAACTCTTTGGGGTGTTCTGGACACCCCCAGATGT
	GTCTGCGATGATTGCTCCCTTACTCGGTGACTACGAGATGCAAGGCCCCGAAGACCTGGCCGTGGAACTTGTGCCCGTGG
	TGATGGGAGGAATAGGTTTGGTGTTAGGATTCACCAAAGAAAAGATCGGCAAGATGCTTTCATCAGCTGCGACCACACTT
	AGGGCCTGCAAGGATCTAGGATCTTATGGATTGGAGATACTCAAATTGGTCATGAAGTGGTTCTTCCCCAAGAAGGAGGA
	GGCTAACGAACTAGCCATGGTGAGGGCCATTGAGGATGCAGTCCTGGATTTGGAGGCAATAGAAAACAATCACATGACCA
	CCCTTCTCAAGGATAAAGACAGCCTGGCCACATACATGAGGACTCTTGACTTGGAAGAAGAGAAAGCAAGGAAACTGTCA
	ACCAAATCGGCGTCACCTGACATCGTGGGTACAATAAACGCATTATTGGCTAGGATAGCAGCCGCCAGGTCACTGGTCCA
	CAAGGCTAAGGAGGAGCTCTCGAGCAGACAGAGACCTGTTGTTGTAATGATATCAGGTAGACCAGGTATAGGAAAGACCC
	ATCTGGCCAGAGAGCTAGCCAAGAAAGTTGCGTCAACACTGTCAGGCGACCAAAGGATTGGACTGGTACCTAGAAATGGC
	GTCGACCATTGGGACGCCTACAAGGGAGAAAGGGTGGTTCTGTGGGATGATTATGGTATGAGCAACCCTATACAGGACGC
	ACTGAGGCTCCAAGAATTGGCTGACACCTGTCCTCTGACCCTAAATTGTGATAGGATTGAAAACAAAGGAAAAGTGTTCG
	ACAGTGATGCCATAATTATAACAACCAACCTTGCAAACCCAGCACCACTAGACTATGTCAACTTTGAGGCCTGCTCTAGA
	CGCATAGACTTCTTGGTGTATGCAGACGCACCTGACATTGAGAAGGCTAAGCGTGACTTCCCTGGCCAACCAGATATGTG
	GAAAGACCATTTCAGACCAGACTTCTCACACATTAAACTTCAGCTGGCACCACAGGGAGGTTTTGACAAAAATGGCAACA
	CCCCACATGGCAAAGGTGTGGTGAAGTCCCTGACGATTGGTTCTCTGATCGCCAGGGCCTCCGGCTTGCTCCACGAGAGA
	ATGGATGAATTCGAGCTCCAAGGCTCTGACCTGCCAACCTTCAATTTTGACCGCAACAAAGTCGCCGCCTTCAGACAATT
	AGCAGCTGAAAACAAATATGGTCTTATGGACACACTGAGGGTCGGCAACCAACTGAAAAGTGTTAAGACCCTGGATGAGC
	TGAAGCAGGCCATAAAGAACATCAGTATCAAGAAGTGTCAGATAGTGTATAATGGATGCACCTATACCATGGAATCTGAT
	GGGAGGGGCAAGGTTGTGGTTGAAAAGGTACAAAACGCAACAGTTCAAACCAACAATGAACTTGTAGGGGCGCTCCACCA
	CCTGAGATCTGCAAGGATAAGATACTATGTTAAATGTTTCCAAGAAGCCATTTACTCTCTACTCCAAATTGCTGGTGCAG
	CCTTCGTCACCTCACGCATCGTGAGGCGCATGAACATATCAAACCTCTGGTCGAAGCCACCCATCGAGGAGGGTGATGAG
	CCTGAAGACAGAGGAGGATGCCCCAAGCCCAGGGATGAAGATGACCTCACTATTGACTCTAGAGACATTAAAGTGGAAGG
	GAAGAAGGGCAAGAACAAGTCTGGCCGGGGCAAGAAACACACAGCCTTCTCTTCCAAGGGCCTCAGTGATGAAGAGTACG
	ATGAGTACAAGAGAATCAGAGAGGAGAGGAATGGCAAATACTCAATAGAGGAATACCTCCAAGATAGGGACAGATACTAT
	GAAGAGCTTGCCATTGCTAAGGCCACTGAGGAGGACTTCTGTGAGGAGGAGGAGATCAAAATCCGCCAGAGAATCTTCCG
	ACCCACCAGGAAGCAGCGGAAAGAGGAAAGGGCCACGCTTGGGCTTGTCACAGGATCGGAAATCAGAAAGAGGAATCCAG
	ATGACTTTAAACCAAAAGGAAAATTGTGGGCTGATGACAACAGGAGCGTGGATTACAATGAGAGGATAGATTTTGAGGCT
	CCCCCGAGTGTTTGGTCTAGGATAGTCAACTTTGGCACAGGCTGGGGATTCTGGGTTTCTCCAAGTCTCTTTATAACTTC
	AACACACGTCATACCAAAAGGAATCACTGAGGCCTTTGGAGTGCCCATAAACCAAATCCAAATTCACAAATCTGGAGAAT
	TTTGCCGCTTGCGGTTTCCAAAGCCAATTAGACCAGACGTGAGTGGGATGATCTTGGAAGAGGGCGCCCCTGAAGGCACT
	GTTGTGTCTATTCTCATCAAAAGGACAACAGGGGAGCTGATGCCTCTTGCAGTCAGAATGGGGACTCATGCCACAATGAA
	AATCCAAGGTAGAACGGTGGGTGGTCAGATGGGTATGCTTCTCACTGGCTCAAATGCTAAAAGCATGGATCTAGGCACAA
	CGCCAGGTGACTGCGGATGTCCATACATATACAAAAGGGGCAATGACCTTGTGGTCATTGGGGTGCACACTGCAGCAGCT
	CGTGGAGGCAACACGGTCATATGTGCCACACAGGGAAGTGAAGGTGAAGCCACTCTTGAAGGAAGTGACAACAAGGGTAC
	CTATTGTGGAGCCCCCATTTTGGGACCTGGCAATGCACCAAAATTGAGCACAAAGACAAAATTCTGGAGATCCTCTAACG
	CACCGCTTCCCCCAGGTACTTATGAACCAGCATACCTTGGTGGGAGAGACCCGCGCGTGAAGGGAGGCCCATCTCTGCAA
	CAAGTTATGAGAGACCAACTTAAACCTTTTACAGAGCCCAGAGGGAAGCCACCAAACCCAAATGTCTTAGAGTCAGCAAA
	GAAGACTATCATCAATGTTCTGGAACAAACCATTGACCCCCCTCAAAAGTGGTCATATGCCCAAGCTTGTGCATCCCTCG
	ACAAGACAACCTCCAGTGGATACCCGCACCACGTCCGGAAGAATGACTATTGGAGTGGTGAATCCTTCACAGGAAAACTT
	GCAGATCAGGCTTCAAAAGCAAATCTCATGTATGAGGAAGGCAAGCACATGCAACCAGTTTACACCGCAGCACTCAAAGA
	CGAGCTCGTGAAAACTGACAAAATTTATGGCAAAATCAAGAAAAGACTCCTGTGGGGTTCTGACCTCTCCACAATGATTC
	GATGCGCCAGAGCATTTGGTGGTCTCATGGATGAATTCAAAGCAAATTGTATTACACTCCCTATCAGAGTTGGTATGAAT
	ATGAATGAAGATGGTCCCATAATATTTGAGAAACACTCCAGGTACAGGTACCACTATGATGCTGATTACTCCCGCTGGGA
	CTCCACACAACAGCGGGCAGTGCTGGAAGCGGCACTTGAAATCATGGTGAGATTTTCTGCTGAGCCACAGCTGGCACAAA
	TAGTGGCAGAGGACCTGCTGTCACCAAGTGTGGTTGATGTGGGCGATTTCAAAATCGCTATCAATGAAGGCCTACCATCT
	GGCGTGCCTTGCACCTCACAATGGAATTCTATTGCCCACTGGTTACTTACCTTGTGTGCCCTTTCTGAAGTGACAGGATT
	AGGTCCTGACATCATACAAGCTAACTCCATGTACTCTTTCTATGGTGATGATGAGATTGTGAGCACAGACATAAAATTGG
	ACCCAGAGAAATTGACCGCAAAGCTCAAAGAATATGGCCTTAAACCCACTCGGCCCGACAAAACTGAGGGGCCGTTGGTG
	ATTAGTGAGGACCTGAATGGGTTGACTTTCCTCCGCCGGACAGTCACCCGTGATCCAGCAGGTTGGTTTGGAAAGTTGGA
	CCAAAACTCCATCCTCAGGCAGTTGTACTGGACAAGAGGACCCAACCATGAAGACCCCAGTGAGACCATGATACCACACG
	CACAAAGACCTGTGCAGCTCATGGCACTACTAGGAGAATCCTCCCTACATGGACCCTCATTTTACAGCAAGGTTAGCAAA
	TTAGTCATATCTGAACTTAAAGAGGGAGGAATGGATTTTTATGTGCCCAGACAAGAGTCAATGTCCAGATGGATGAGGTT
	CTCAGATCTAAGCACATGGGAGGGCGATCGCAATCTGGCTCCCAGTTTTGTGAATGAAGATGGCGTCGAATGACGCCGCT
	CCATCTAATGATGGTGCTGCTGGTCTCGTACCAGAGGGCAACAACGAGACCCTTCCCCTAGAACCAGTTGCGGGCGCAGC
	TATAGCCGCACCCGTCACTGGCCAAAATAACATAATTGACCCCTGGATTAGAACAAATTTTGTGCAAGCACCAAATGGAG
	AGTTCACAGTGTCACCCAGAAACTCTCCTGGAGAAATTTTATTAAACTTAGAGTTGGGCCCTGATTTGAACCCTTATTTG
	GCTCATTTGTCAAGGATGTACAATGGGTATGCTGGTGGAGTGGAAGTTCAGGTTCTCCTGGCAGGGAACGCGTTCACTGC
	CGGAAAGATCCTCTTCGCCGCCGTCCCGCCAAATTTCCCAGTGGAATTCTTAAGCCCAGCCCAGATCACAATGCTCCCAC
	ATTTAATAGTAGATGTTAGGACTCTTGAACCAATTATGATCCCACTCCCTGATGTTAGGAATACATTCTTCCATTATAGT
	AACCAGCCTAACAGCCGCATGAGATTAGTGGCTATGCTCTATACCCCACTCAGATCTAATGGCTCAGGTGATGATGTCTT
	TACTGTCTCTTGCAGGGTTTTGACTAGGCCTACTCCTGATTTTGAGTTCACTTATTTAGTGCCACCTTCTGTTGAATCTA
	AAACTAAGCCTTTTTCCTTACCTATTTTAACCCTTTCTGAGCTCACAAATTCGAGGTTCCCAGTCCCCATCGATTCGCTT
	TTCACCGCCCAGAATAATGTGTTGCAGGTGCAGTGTCAAAATGGCAGGTGTACACTTGATGGTGAGTTACAAGGCACAAC
	CCAGTTGCTCCCATCTGGCATCTGTGCATTCAGAGGACGGGTGACAGCACAAATTAACCAACGTGACAGGTGGCACATGC
	AACTGCAAAACCTCAATGGTACAACATATGACCCAACTGATGATGTGCCAGCCCCGCTGGGTACACCTGACTTCAAGGGC
	GTCGTGTTTGGGATGGTAAGCCAAAGAAATGTGGGTAATGATGCGCCTGGCTCAACCAGAGCCCAACAGGCGTGGGTTTC
	AACCTATAGCCCCCAATTTGTCCCCAAATTAGGTTCTGTCAATCTTAGAATTAGTGATAATGATGATTTCCAATTCCAGC
	CGACAAAATTCACACCAGTGGGCGTCAATGATGACGATGATGGCCACCCGTTCAGACAATGGGAACTACCAAACTATTCA
	GGGGAGCTTACCTTGAATATGAATCTTGCCCCCCCAGTTGCTCCAAATTTTCCTGGTGAACAATTGTTATTCTTCAGATC
	TTTCGTGCCATGCTCAGGAGGTTACAACCAAGGTATTATAGATTGTCTTATTCCCCAAGAATGGATCCAACACTTCTATC
	AGGAATCAGCACCCTCCCAGTCAGACGTGGCCCTAATCAGGTATGTCAACCCCGATACGGGACGTACACTGTTTGAAGCA
	AAATTGCACAGATCTGGTTACATTACTGTGGCTCACTCTGGAGACTATCCTCTTGTTGTTCCGGCTAATGGACACTTTAG
	ATTTGATTCTTGGGTAAATCAGTTTTACTCACTCGCCCCAATGGGAACTGGGAATGGGCGAAGGAGGGCTCAGTAATGGC
	TGGGGCTTTCATTGCAGGATTGGCAGGCGACATGCTCACGTCATCTGTGGGCTCCCTTGTGAACGCAGGGGCAAACGCCA
	TCAACCAAAAGATAGACTTTGAAAACAACAAACAACTCCAGTCTGCTTCCTTTCAGCATGATAAAGAGATGCTCCAAGCG
	CAGGTGAGGGCGACCAAGCAGCTGCAATCTGAAATGATAGCCCTAAAACAGGGGGTTTTGGCCGCAGGCGGCTTTTCCCC
	CACTGATGCAGCAAGGGGATCCATTGGTGCACCCATGACAAAGGTGCTTGACTGGTCTGGCACTCGATACTGGGCGCCCA
	ATTCCACAAAGACAACTGGCTATTCGGGACAATTCACCTCTTCACCTGTGCATATGTCTAGCCCAAATGCTCCACAATCA
	AAACCTGCAAAGCCTAGGTCTCTAGCTCCTTCCTCTTCTTCTAGCAGTGTCTATAGTATGTATACTCAATCTACTCATTT
	AACATCTGGCTCTTCTAGTAATGCTTCTTCTGCCTCCACAAAATTGACAAATTTAAGCTCTGGCTCCTCTCAAAACAGAA
	CAGCAGAGTGGGTAAATCAACAGAGAAGTCTTAGCCCTTTCATGAGTGGCGCACTTAACATCTCACATGTCACGCCACCC
	TCAAGTAGGGCTTCCAGTTCTGGGACGGTCTCGACCGTGCCCAAGGAAGTTTTGGACTCCTGGACGTCTGCGTTTAACAC
	ACACAGACAGCCGCTCTTCGCACACCTCAGAGTGAGGGGGGAGTCACGTGTTTAGTGAAAAGAAATAATTGGCTATAATG
	TGATTTCTTTCTAATTTTGGCTAATTTGTATCTTTT`
	// 测试用例
	positionsF1 := getPrimerPositionOnGenome("CARGARBCNATGTTYAGRTGGATGAG", genomeSequence, 2, 'F')
	positionsF2 := getPrimerPositionOnGenome("CNTGGGAGGGCGATCGCAA", genomeSequence, 2, 'F')
	positionsR1 := getPrimerPositionOnGenome("CCRCCNGCATRHCCRTTRTACAT", genomeSequence, 2, 'R')

	fmt.Fprintln(os.Stdout, positionsF1, positionsF2, positionsR1)
}
